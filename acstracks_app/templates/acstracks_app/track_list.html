{% extends 'acstracks_app/base.html' %}

{% block content %}
    <h3>Add your GPS file(s):</h3>
    <form method="post" enctype="multipart/form-data">
    {% csrf_token %}
        <input type="file" id="myfile" name="myfile" accept=".gpx" multiple>
        <input type="submit">
    </form>
    {% if statistics.total_length > 0 %}
    <table>
        <tr>
            <td><b>Total length</b></td><td style="text-align:right">{{ statistics.total_length }}</td>
        </tr>
        <tr>
            <td><b>Total average speed</b></td><td style="text-align:right">{{ statistics.total_avgspeed }}</td>
        </tr>
        <tr>
            <td><b>Longest track</b></td><td style="text-align:right">{{ statistics.longest_length }}</td>
            <td>{{ statistics.datetime_longest_length|date:"d b Y" }}</td>
        </tr>
        <tr>
            <td><b>Longest duration</b></td><td style="text-align:right">{{ statistics.longest_duration }}</td>
            <td>{{ statistics.datetime_longest_duration|date:"d b Y" }}</td>
        </tr>
        <tr>
            <td><b>Highest maximum speed</b></td><td style="text-align:right">{{ statistics.highest_maxspeed }}</td>
            <td>{{ statistics.datetime_highest_maxspeed|date:"d b Y" }}</td>
        </tr>
        <tr>
            <td><b>Highest average speed</b></td><td style="text-align:right">{{ statistics.highest_avgspeed }}</td>
            <td>{{ statistics.datetime_highest_avgspeed|date:"d b Y" }}</td>
        </tr>
    </table><br><br>
    {% endif %}        
    <table style="width:100%">
        <th valign="Top" width=400>Filename</th>
        <th valign="Top" width=200>Created date</th>
        <th valign="Top" width=200>Name</th>
        <th valign="Top">
            <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
            <script>
                function profileFunction() {
                    var x = document.getElementById("profile").value;
                    this.form.submit()
                }
            </script>
            <label for="Profile">Profile:</label>
            <select name="Profile" id="profile" onclick=this.form.submit()>
            {% if profiles %}
                {% for profile in profiles %}
                    {% if profile == profile_filter %}
                        <option value={{ profile }} selected="selected">{{ profile }}</option>
                    {% else %}
                        <option value={{ profile }}>{{ profile }}</option>
                    {% endif %}
                {% endfor %}
            {% endif %}
            </select>
            </form>
        </th>
        <th valign="Top" style="text-align:right">Length</th>
        <th valign="Top" style="text-align:right">Duration</th>
        <th valign="Top" style="text-align:right">Average<br>speed</th>
        <th valign="Top" style="text-align:right">Maximum<br>speed</th>
        <th valign="Top" style="text-align:right">Average<br>cadence</th>
        <th valign="Top" style="text-align:right">Maximum<br>cadence</th>
        <th valign="Top" style="text-align:right">Average<br>heartrate</th>
        <th valign="Top" style="text-align:right">Mininimum<br> heartrate</th>
        <th valign="Top" style="text-align:right">Maximum<br>heartrate</th>
        {% for track in tracks %}
            <tr>
                <td><a href="{% url 'track_detail' pk=track.pk %}">{{ track.filename }}</a></td>
                <td>{{ track.created_date|date:"d b Y" }}</td>
                <td>{{ track.name }}</td>
                <td>{{ track.profile }}</td>
                <td  style="text-align:right">{{ track.length }}</td>
                <td  style="text-align:right">{{ track.timelength|time:"H:i:s" }}</td>
                <td style="text-align:right">{{ track.avgspeed }}</td>
                <td style="text-align:right">{{ track.maxspeed }}</td>
                {% if track.avgcadence %}
                    <td style="text-align:right">{{ track.avgcadence }}</td>
                {% else %}
                    <td  style="text-align:right">-</td>
                {% endif %}
                {% if track.maxcadence %}
                    <td  style="text-align:right">{{ track.maxcadence }}</td>
                    {% else %}
                    <td  style="text-align:right">-</td>
                {% endif %}
                {% if track.avgheartrate %}
                    <td  style="text-align:right">{{ track.avgheartrate }}</td>
                {% else %}
                    <td  style="text-align:right">-</td>
                {% endif %}
                {% if track.minheartrate %}
                    <td  style="text-align:right">{{ track.minheartrate }}</td>
                {% else %}
                    <td  style="text-align:right">-</td>
                {% endif %}
                {% if track.maxheartrate %}
                    <td  style="text-align:right">{{ track.maxheartrate }}</td>
                {% else %}
                    <td  style="text-align:right">-</td>
                {% endif %}
                </tr>
        {% endfor %}
    </table>
{% endblock %}